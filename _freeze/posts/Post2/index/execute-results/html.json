{
  "hash": "09162a3c78008114e170948816216f0f",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"index\"\nformat: html\n---\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: package 'ggplot2' was built under R version 4.4.3\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: package 'tibble' was built under R version 4.4.3\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: package 'tidyr' was built under R version 4.4.3\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: package 'purrr' was built under R version 4.4.3\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: package 'dplyr' was built under R version 4.4.3\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: package 'lubridate' was built under R version 4.4.3\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.2.0     ✔ readr     2.1.5\n✔ forcats   1.0.0     ✔ stringr   1.6.0\n✔ ggplot2   4.0.2     ✔ tibble    3.3.1\n✔ lubridate 1.9.5     ✔ tidyr     1.3.2\n✔ purrr     1.2.1     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(baseballr)\nlibrary(here)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nhere() starts at /Users/jacobilafferty/Library/CloudStorage/OneDrive-St.LawrenceUniversity/DATA-334/ds334_blog\n```\n\n\n:::\n\n```{.r .cell-code}\nsalaries <- read_csv(here(\"posts\", \"Post2\", \"mlb_payrolls.csv\"))\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nRows: 420 Columns: 12\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (8): Team, Team Name, Total Payroll Allocations, Active 26-Man, Injured,...\ndbl (4): Year, Average Age, Wins, Losses\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n\n\n:::\n\n```{.r .cell-code}\nsalaries <- salaries |> filter(Year > 2014) |>\n  mutate(win_pct = Wins / 162,\n         Payroll = gsub(\"\\\\$\", \"\", `Total Payroll Allocations`),\n         Payroll = gsub(\",\", \"\", Payroll),\n         Payroll = as.numeric(Payroll),\n         Payroll = Payroll / 1000000,\n         efficiency = Payroll / Wins\n         )\n```\n:::\n\n\n# Highest Payrolls\n\n\n::: {.cell}\n\n```{.r .cell-code}\nexpensive_teams <- salaries |> group_by(Team) |>\n  summarise(avg_payroll = mean(Payroll),\n            avg_win_pct = mean(win_pct)) |>\n  mutate(Team = fct_reorder(Team, avg_win_pct))\n\nggplot(data = expensive_teams, aes(x = avg_payroll, y = Team)) +\n  geom_segment(aes(xend = 0, yend = Team, color = avg_win_pct)) +\n  geom_point() +\n  theme_minimal() +\n  scale_color_viridis_c() +\n  labs(\n    title = \"Average MLB Payrolls\",\n    subtitle = \"(2015–2024)\",\n    x = \"Average Annual Payroll (in Millions)\",\n    y = \"MLB Franchise\",\n    color = \"Win %\"\n  )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\n\n# Payroll vs Win Percentage\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = salaries, aes(x = Payroll, y = win_pct)) +\n  geom_point() +\n  theme_minimal() +\n  geom_smooth() +\n  labs(\n    title = \"Payroll vs Win Percentage\",\n    subtitle = \"(2015-2024)\",\n    x = \"Total Payroll (in Millions)\",\n    y = \"Regular Season Win %\"\n  )\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`geom_smooth()` using method = 'loess' and formula = 'y ~ x'\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\n# Top 15 Efficiency\n\n::: {.cell}\n\n```{.r .cell-code}\nefficiency_seasons <- salaries |> \n  filter(Wins > 81) |>\n  mutate(Team_Year = paste(Team, Year),\n         Team_Year = fct_reorder(Team_Year, efficiency)) |> \n  arrange(efficiency) |> \n  head(15)\n\nggplot(efficiency_seasons, aes(x = win_pct, y = Team_Year)) +\n  geom_segment(aes(xend = 0, yend = Team_Year, color = Team), linewidth = 1.5) +\n  geom_point(aes(color = Team), size = 2) +\n  labs(\n    title = \"Most Efficient Teams\",\n    subtitle = \"Top 15 most efficient seasons by cost per win (2015–2024)\",\n    x = \"Regular Season Win %\",\n    y = \"Team\"\n  ) +\n  theme_minimal() +\n  scale_color_manual(values = c(\n    \"TB\"  = \"#092C5C\", # Rays\n    \"OAK\" = \"#003831\", # Athletics\n    \"CLE\" = \"#E31937\", # Guardians/Indians\n    \"MIL\" = \"#12284B\", # Brewers\n    \"ARI\" = \"#A71930\", # Diamondbacks\n    \"HOU\" = \"#EB6E1F\", # Astros\n    \"SEA\" = \"#005C5C\", # Mariners (Northwest Green)\n    \"PIT\" = \"#FDB827\", # Pirates (Gold)\n    \"BAL\" = \"#DF4601\"  # Orioles (Orange)\n  )) +\n  theme(legend.position = \"none\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\n# Top 15 Salary\n\n::: {.cell}\n\n```{.r .cell-code}\nsalary_seasons <- salaries |> \n  mutate(Team_Year = paste(Team, Year),\n         Team_Year = fct_reorder(Team_Year, Payroll)) |> \n  arrange(desc(Payroll)) |> \n  head(15)\n\nggplot(salary_seasons, aes(x = win_pct, y = Team_Year)) +\n  geom_segment(aes(xend = 0, yend = Team_Year, color = Team), linewidth = 1.5) +\n  geom_point(aes(color = Team), size = 2)+\n  scale_color_manual(values = c(\n    \"NYM\" = \"#002D72\", # Mets Blue\n    \"NYY\" = \"#003087\", # Yankees Navy\n    \"LAD\" = \"#005A9C\", # Dodgers Blue\n    \"HOU\" = \"#EB6E1F\", # Astros Orange\n    \"SD\"  = \"#2F241D\", # Padres Brown\n    \"TEX\" = \"#003278\", # Rangers Blue\n    \"PHI\" = \"#E81828\"  # Phillies Red\n  )) +\n\n  labs(\n    title = \"Most Expensive Teams\",\n    subtitle = \"Top 15 most expensive seasons (2015–2024)\",\n    x = \"Win %\",\n    y = \"Teams\"\n  ) +\n  theme_minimal() +\n  theme(legend.position = \"none\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\n# Comparing Most Efficient and Most Expensive\n\n::: {.cell}\n\n```{.r .cell-code}\ncomparison_data <- bind_rows(\n  mutate(efficiency_seasons, Category = \"Efficiency\"),\n  mutate(salary_seasons, Category = \"Expensive\")\n)\n\nggplot(comparison_data, aes(x = Category, y = win_pct)) +\n  geom_boxplot() +\n  labs(\n    title = \"Efficient Teams vs Expensive Teams\",\n    subtitle = \"Comparing win percentages of the Top 15 seasons in each strategy (2015-2024)\",\n    x = \"\",\n    y = \"Win %\"\n  ) +\n  theme_minimal() +\n  theme(\n    legend.position = \"none\"\n  )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\n\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}